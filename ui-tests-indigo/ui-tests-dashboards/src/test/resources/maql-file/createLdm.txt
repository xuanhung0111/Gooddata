CREATE FOLDER {dim.person} VISUAL(TITLE "person") TYPE ATTRIBUTE;
CREATE FOLDER {dim.opportunity} VISUAL(TITLE "opportunity") TYPE ATTRIBUTE;
CREATE FOLDER {ffld.person} VISUAL(TITLE "person") TYPE FACT;
CREATE FOLDER {ffld.opportunity} VISUAL(TITLE "opportunity") TYPE FACT;
CREATE DATASET {dataset.person} VISUAL(TITLE "person");
CREATE DATASET {dataset.opportunity} VISUAL(TITLE "opportunity");
CREATE ATTRIBUTE {attr.person.factsof} VISUAL(TITLE "Records of person", FOLDER {dim.person}) AS KEYS {f_person.id} FULLSET;
ALTER DATASET {dataset.person} ADD {attr.person.factsof};
CREATE ATTRIBUTE {attr.person.person} VISUAL(TITLE "person", FOLDER {dim.person}) AS KEYS {d_person_person.id} FULLSET, {f_person.person_id};
ALTER DATASET {dataset.person} ADD {attr.person.person};
ALTER ATTRIBUTE {attr.person.person} ADD LABELS {label.person.person.personid} VISUAL(TITLE "personId") AS {d_person_person.nm_personid};
ALTER ATTRIBUTE {attr.person.person} ADD LABELS {label.person.person.lastname} VISUAL(TITLE "lastname") AS {d_person_person.nm_lastname};
ALTER ATTRIBUTE {attr.person.person} ADD LABELS {label.person.person.firstname} VISUAL(TITLE "firstname") AS {d_person_person.nm_firstname};
ALTER ATTRIBUTE {attr.person.person} ADD LABELS {label.person.person} VISUAL(TITLE "person") AS {d_person_person.nm_person};
CREATE ATTRIBUTE {attr.opportunity.name} VISUAL(TITLE "name", FOLDER {dim.opportunity}) AS KEYS {f_opportunity.id} FULLSET;
ALTER DATASET {dataset.opportunity} ADD {attr.opportunity.name};
ALTER ATTRIBUTE {attr.opportunity.name} ADD LABELS {label.opportunity.name} VISUAL(TITLE "name") AS {f_opportunity.nm_name};
CREATE ATTRIBUTE {attr.opportunity.title} VISUAL(TITLE "title", FOLDER {dim.opportunity}) AS KEYS {d_opportunity_title.id} FULLSET, {f_opportunity.title_id};
ALTER DATASET {dataset.opportunity} ADD {attr.opportunity.title};
ALTER ATTRIBUTE {attr.opportunity.title} ADD LABELS {label.opportunity.title} VISUAL(TITLE "title") AS {d_opportunity_title.nm_title};
CREATE FACT {fact.person.age} VISUAL(TITLE "age", FOLDER {ffld.person}) AS {f_person.f_age};
ALTER DATATYPE {f_person.f_age} DECIMAL(15,2);
ALTER DATASET {dataset.person} ADD {fact.person.age};
CREATE FACT {fact.opportunity.price} VISUAL(TITLE "price", FOLDER {ffld.opportunity}) AS {f_opportunity.f_price};
ALTER DATATYPE {f_opportunity.f_price} DECIMAL(15,2);
ALTER DATASET {dataset.opportunity} ADD {fact.opportunity.price};
CREATE FACT {fact.opportunity.totalprice} VISUAL(TITLE "totalprice", FOLDER {ffld.opportunity}) AS {f_opportunity.f_totalprice};
ALTER DATATYPE {f_opportunity.f_totalprice} DECIMAL(15,2);
ALTER DATASET {dataset.opportunity} ADD {fact.opportunity.totalprice};
SYNCHRONIZE {dataset.opportunity}, {dataset.person};