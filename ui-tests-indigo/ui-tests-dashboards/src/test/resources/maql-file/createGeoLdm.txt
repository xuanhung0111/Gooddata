CREATE DATASET {dataset.geopushpin} VISUAL(TITLE "GEO Pushpin");
CREATE FOLDER {dim.geopushpin} VISUAL(TITLE "GEO Pushpin") TYPE ATTRIBUTE;
CREATE ATTRIBUTE {attr.geopushpin.factsof} VISUAL(TITLE "Records of GEO Pushpin", FOLDER {dim.geopushpin}) AS KEYS {f_geopushpin.id} FULLSET;
ALTER DATASET {dataset.geopushpin} ADD {attr.geopushpin.factsof};
CREATE ATTRIBUTE {attr.geopushpin.city} VISUAL(TITLE "city", FOLDER {dim.geopushpin}) AS KEYS {d_geopushpin_city.id} FULLSET, {f_geopushpin.city_id};
ALTER DATASET {dataset.geopushpin} ADD {attr.geopushpin.city};
ALTER ATTRIBUTE {attr.geopushpin.city} ADD LABELS {label.geopushpin.city} VISUAL(TITLE "city") AS {d_geopushpin_city.nm_city};
ALTER ATTRIBUTE {attr.geopushpin.city} ADD LABELS {label.geopushpin.city.latlong} VISUAL(TITLE "latlong") AS {d_geopushpin_city.nm_latlong};
ALTER ATTRIBUTE {attr.geopushpin.city} DEFAULT LABEL {label.geopushpin.city};
CREATE ATTRIBUTE {attr.geopushpin.state} VISUAL(TITLE "state", FOLDER {dim.geopushpin}) AS KEYS {d_geopushpin_state.id} FULLSET, {f_geopushpin.state_id};
ALTER DATASET {dataset.geopushpin} ADD {attr.geopushpin.state};
ALTER ATTRIBUTE {attr.geopushpin.state} ADD LABELS {label.geopushpin.state.code} VISUAL(TITLE "code") AS {d_geopushpin_state.nm_code};
ALTER ATTRIBUTE {attr.geopushpin.state} ADD LABELS {label.geopushpin.state} VISUAL(TITLE "state") AS {d_geopushpin_state.nm_state};
CREATE ATTRIBUTE {attr.geopushpin.country} VISUAL(TITLE "timezone", FOLDER {dim.geopushpin}) AS KEYS {d_geopushpin_country.id} FULLSET, {f_geopushpin.country_id};
ALTER DATASET {dataset.geopushpin} ADD {attr.geopushpin.country};
ALTER ATTRIBUTE {attr.geopushpin.country} ADD LABELS {label.geopushpin.country} VISUAL(TITLE "timezone") AS {d_geopushpin_country.nm_country};
CREATE ATTRIBUTE {attr.geopushpin.district} VISUAL(TITLE "district", FOLDER {dim.geopushpin}) AS KEYS {d_geopushpin_district.id} FULLSET, {f_geopushpin.district_id};
ALTER DATASET {dataset.geopushpin} ADD {attr.geopushpin.district};
ALTER ATTRIBUTE {attr.geopushpin.district} ADD LABELS {label.geopushpin.district.id} VISUAL(TITLE "code") AS {d_geopushpin_district.nm_id};
ALTER ATTRIBUTE {attr.geopushpin.district} ADD LABELS {label.geopushpin.district} VISUAL(TITLE "district") AS {d_geopushpin_district.nm_district};
CREATE FOLDER {ffld.geopushpin} VISUAL(TITLE "GEO Pushpin") TYPE FACT;
CREATE FACT {fact.geopushpin.population} VISUAL(TITLE "population", FOLDER {ffld.geopushpin}) AS {f_geopushpin.f_population};
ALTER DATASET {dataset.geopushpin} ADD {fact.geopushpin.population};
SYNCHRONIZE {dataset.geopushpin};